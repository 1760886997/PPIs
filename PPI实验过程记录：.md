# PPI实验过程记录：

关于这里，我想说明：

##### 1.什么是ppi:

ppi是蛋白质对相互作用关系的简称，我的实验是做蛋白质对之间相互作用关系预测。

##### 2.一共有那些作用关系：

```python
'reaction': 0, 'binding': 1, 'ptmod': 2, 'activation': 3, 'inhibition': 4,'catalysis': 5,'expression': 6
```

类别一共有七种，并且用onehot编码嵌入

3.这个模型的基础模型是：GNN_PPI

##### 4.我们的模型：

![image-20240326102358582](C:\Users\X.F\AppData\Roaming\Typora\typora-user-images\image-20240326102358582.png)

##### 5：模型介绍：

我们想的是提取出蛋白质序列特征中对于特定类别的特定特征，所以先把蛋白质表划分为七份<1>；接着我们引入条件概率矩阵，所谓条件概率矩阵就是已知类别A的情况下同时存在类别B的概率；这时围绕条件概率我们的模型又分为：蛋白质特征与条件概率直接相乘<2>,池化每一层的解耦类别，组成的7*7的矩阵和条件概率矩阵做对齐<3>,对损失函数操作，将条件概率的损失前面加上一个权重<3>。

![image-20240327154216170](C:\Users\X.F\AppData\Roaming\Typora\typora-user-images\image-20240327154216170.png)

###### <0>gnn_ppi：

| SHS27k  | random      | bfs   | dfs         |
| ------- | ----------- | ----- | ----------- |
| 1       | 89.38       | 70.15 | 71.59       |
| 2       | 87.91       | 67.48 | 72.37       |
| 3       | 89.04       | 74.36 | 72.32       |
| avg     | 88.77666667 | 70.66 | 72.09333333 |
| shS148k | random      | bfs   | dfs         |
| 4       | 92.3        | 73.61 | 84.18       |
| 5       | 92.01       | 72.18 | 83.7        |
| 6       | 92.51       | 69.85 | 82.68       |
| avg     | 92.27333333 | 71.88 | 83.52       |

###### <1>蛋白质特征直接解耦出来七个类别（FX4.py)

| SHS27k | bfs         | dfs   |
| ------ | ----------- | ----- |
| 1      | 69.45       | 73.81 |
| 2      | 59.36       | 72.33 |
| 3      | 72.86       | 71.39 |
| avg    | 67.22333333 | 72.51 |

###### <2>蛋白质特征直接解耦出来七个类别并与条件概率相乘（FX3.py）(FX7.py)

| SHS27k | bfs         | dfs         |
| :----- | ----------- | ----------- |
| 1      | 70.95       | 73.57       |
| 2      | 58.87       | 73.47       |
| 3      | 72.58       | 73.27       |
| avg    | 67.46666667 | 73.43666667 |

###### <3>调参                                                                                                      

| SHS27k | bfs         | dfs   |
| ------ | ----------- | ----- |
| 1      | 61.46       | 67.99 |
| 2      | 56.07       | 68.02 |
| 3      | 68.79       | 68.77 |
| avg    | 62.10666667 | 68.26 |

###### <4>引入条件概率矩阵，同时池化解耦出来的每一种类别的特征向量，组成的f矩阵和条件概率矩阵p做对齐（FX1.py)

| SHS27k | bfs         | dfs   |
| ------ | ----------- | ----- |
| 1      | 57.58       | 60.46 |
| 2      | 54.56       | 58.76 |
| 3      | 51.05       | 57.21 |
| avg    | 54.39666666 | 58.81 |

###### <5>对于f和p的损失函数，我赋予了一个0.1的权重，需要条件概率约束但是不能过于约束。(复现.py)

| SHS27k | bfs         | dfs         |
| ------ | ----------- | ----------- |
| 1      | 62.49       | 66.30       |
| 2      | 54.93       | 60.93       |
| 3      | 64.66       | 63.91       |
| avg    | 60.69333333 | 63.71333333 |

<6>对于f，想着用一个温度系数去优化它， 使之其与条件概率矩阵更加接近

f:

![image-20240327194552448](C:\Users\X.F\AppData\Roaming\Typora\typora-user-images\image-20240327194552448.png)

p:

![image-20240327194619614](C:\Users\X.F\AppData\Roaming\Typora\typora-user-images\image-20240327194619614.png)

| SHS27k | bfs   | dfs         |
| ------ | ----- | ----------- |
| 1      | 67.76 | 72.61       |
| 2      | 57.34 | 71.11       |
| 3      | 71.43 | 70.97       |
| avg    | 65.51 | 71.56333333 |

<7>当我发现使用parameter()函数可以使解耦出来的特征差异性更大时，我在<2>的基础上做了parameter操作（FX6.py）

| SHS27k | bfs         | dfs   |
| ------ | ----------- | ----- |
| 1      | 70.41       | 74.20 |
| 2      | 58.51       | 71.59 |
| 3      | 73.00       | 73.72 |
| avg    | 67.30666666 | 73.17 |

<8>注意到之前的f矩阵出现了比1大的值，现在对其做了归一化（FX9.py）

| SHS27k      | random      | bfs         | dfs         |
| ----------- | ----------- | ----------- | ----------- |
| 1           | 89.14       | 70.33       | 74.95       |
| 2           | 87.58       | 62.87       | 73.91       |
| 3           | 88.05       | 73.36       | 73.15       |
| avg         | 88.25666666 | 68.85333333 | 74.00333333 |
| **SHS148k** | **random**  | **bfs**     | **dfs**     |
| 4           | 91.80       | 76.98       | 83.56       |
| 5           | 91.42       | 73.24       | 82.98       |
| 6           | 91.78       | 73.1        | 83          |
| avg         | 91.67       | 74.44       | 83.18       |

<9>接下来跑string数据集

gnn_ppi:

| string | random | bfs   | dfs   |
| ------ | ------ | ----- | ----- |
|        | 95.08  | 69.91 | 90.47 |
|        | 95.11  | 81.56 | 90.71 |
|        | 94.54  | 76.49 | 90.23 |
|        | 94.91  | 75.98 | 90.47 |

 ours:

| string | random | bfs   | dfs   |
| ------ | ------ | ----- | ----- |
|        |        | 71.56 | 90.18 |
|        |        | 81.68 | 90.50 |
|        |        | 76.46 | 90.04 |
|        |        | 76.57 | 90.24 |

<10>

|         | SHS27k |       | SHS148k |       | STRING |       |
| ------- | ------ | ----- | ------- | ----- | ------ | ----- |
|         | BFS    | DFS   | BFS     | DFS   | BFS    | DFS   |
| gnn_ppi | 68.24  | 72.09 | 71.88   | 83.52 | 75.98  | 90.47 |
| ours    | 68.85  | 74.01 | 74.44   | 83.18 | 76.57  | 90.24 |

<11>semi-gnn

![image-20240603104303345](C:\Users\X.F\AppData\Roaming\Typora\typora-user-images\image-20240603104303345.png)

<12>接着记录random的实验数据（总体）

|        | 27K       |             | 148k      |             | string    |             |
| ------ | --------- | ----------- | --------- | ----------- | --------- | ----------- |
|        | gnn_ppi   | ours        | gnn_ppi   | ours        | gnn_ppi   | ours        |
| random | 89.38     | 88.52       | 92.3      | 91.8        | 95.08     |             |
| 87.91  | 87.35     | 92.01       | 91.42     | 95.11       | 95.11     |             |
| 89.04  | 88.19     | 92.51       | 91.78     | 94.54       | 94.54     |             |
| avg    | **88.78** | **88.02**   | **92.27** | **91.67**   | **94.91** |             |
| bfs    | 70.15     | 70.33       | 73.61     | 76.98       | 69.91     | 71.56       |
| 60.22  | 62.87     | 72.18       | 73.24     | 81.56       | 81.68     | 81.68       |
| 74.36  | 73.36     | 69.85       | 73.1      | 76.49       | 76.46     | 76.46       |
| avg    | **68.24** | ***68.85*** | **71.88** | ***74.44*** | **75.98** | ***76.57*** |
| dfs    | 71.59     | 76.98       | 84.18     | 83.56       | 90.47     | 90.18       |
| 72.37  | 73.24     | 83.7        | 82.98     | 90.71       | 90.50     | 90.50       |
| 72.32  | 73.1      | 82.68       | 83        | 90.23       | 90.04     | 90.04       |
| avg    | **72.09** | ***74.44*** | **83.52** | **83.18**   | **90.47** | **90.24**   |

<13>现在修改了之前的池化操作（FX13.PY)

| **SHS27K** | **random**        | **bfs**            | **dfs**            |
| ---------- | ----------------- | ------------------ | ------------------ |
|            | **89.08**         | **71.52**          | **75.79**          |
|            | **87.85**         | **67.74**          | **76.42**          |
|            | **88.87**         | **73.73**          | **75**             |
| **avg**    | **88.6**（-0.17） | **70.99**（+0.33） | **75.73**（+3.64） |
| **148k**   | random            | bfs                | dfs                |
|            | 92.82             | 79.84              | 85.48              |
|            | 92.25             | 73.72              | 83.79              |
|            | 92.66             | 74.32              | 84.64              |
| **avg**    | **92.57**         | **75.96**          | **84.43**          |

<14>讨论得出Q矩阵有一点不正常，需要做一些处理；第一种方法，将p和pT相乘，使其对称（无可解释性）（FX15.py)

| SHS27K | random | bfs          | dfs         |
| ------ | ------ | ------------ | ----------- |
|        |        | 71.7         | 76.41       |
|        |        | 68.06        | 75.49       |
|        |        | 73.62        | 73.98       |
| avg    |        | 71.12(+0.46) | 75.29(+3.2) |

<15>对矩阵Q的分量两两组合，使其不对称（FX16.PY）:

| SHS27K | random | bfs          | dfs          |
| ------ | ------ | ------------ | ------------ |
|        | 89.15  | 71.14        | 76.96        |
|        | 87.45  | 68.81        | 74.88        |
|        | 88.53  | 73.92        | 74.85        |
| avg    | 88.37  | 71.29(+0.63) | 75.56(+3.47) |

<16>继续对Q矩阵做优化 ，对比了三种激活函数：

| SHS27K  | BFS   |       |       | AVG          |
| ------- | ----- | ----- | ----- | ------------ |
| Relu    | 71.24 | 67.13 | 74.28 | 70.88(+0.22) |
| Sigmoid | 72.32 | 67.94 | 73.35 | 71.20(+0.54) |
| Tanh    | 71.4  | 67.45 | 74.43 | 71.09(+0.43) |

| SHS27K  | dfs   |       |       | AVG          |
| ------- | ----- | ----- | ----- | ------------ |
| Relu    | 76.42 | 73.60 | 75.17 | 75.06(+2.97) |
| Sigmoid | 76.09 | 74.42 | 73.35 | 74.62(+2.53) |
| Tanh    | 74.48 | 75.42 | 74.65 | 74.85(+2.76) |

<17>在<15>的基础之上，跑了148k数据集：

| SHS148K | random | bfs   | dfs   |
| ------- | ------ | ----- | ----- |
|         | 92.87  | 79.86 | 85.59 |
|         | 92.76  | 72.79 | 84.72 |
|         | 92.60  | 75.96 | 83.87 |
| avg     | 92.74  | 76.20 | 84.72 |

|         | SHS27K |       |       | SHS148K |       |       |
| ------- | ------ | ----- | ----- | ------- | ----- | ----- |
|         | random | bfs   | dfs   | radom   | bfs   | dfs   |
| gnn_ppi | 88.77  | 70.66 | 72.09 | 92.27   | 71.88 | 83.52 |
| old     | 88.02  | 70.98 | 74.44 | 91.67   | 74.44 | 83.18 |
| new     | 88.37  | 71.29 | 75.56 | 92.74   | 76.2  | 84.72 |
